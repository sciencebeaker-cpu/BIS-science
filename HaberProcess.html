<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Haber Process Manager - MYP5 Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        .gauge-fill { transition: width 0.5s ease-out, background-color 0.5s; }
        .factory-pipe { transition: all 1s ease; }
    </style>
</head>
<body class="bg-slate-900 text-white">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            // Inputs
            const [temp, setTemp] = useState(450); // Celsius
            const [pressure, setPressure] = useState(200); // Atm
            
            // Outputs
            const [yieldVal, setYieldVal] = useState(0);
            const [rateVal, setRateVal] = useState(0);
            const [costVal, setCostVal] = useState(0);
            const [dailyProfit, setDailyProfit] = useState(0);
            const [feedback, setFeedback] = useState("");

            useEffect(() => {
                calculateMetrics();
            }, [temp, pressure]);

            const calculateMetrics = () => {
                // SCIENTIFIC LOGIC SIMULATION
                
                // 1. YIELD (Equilibrium)
                // Exothermic: High Temp = Low Yield
                // High Pressure = High Yield (4 moles -> 2 moles)
                const tempFactorYield = Math.max(0, 100 - ((temp - 200) * 0.15)); 
                const pressureFactorYield = Math.min(100, (pressure / 400) * 100);
                const calculatedYield = (tempFactorYield * 0.6 + pressureFactorYield * 0.4);

                // 2. RATE (Kinetics)
                // High Temp = High Rate
                // High Pressure = High Rate
                const tempFactorRate = ((temp - 200) / 500) * 100;
                const pressureFactorRate = (pressure / 400) * 100;
                const calculatedRate = (tempFactorRate * 0.7 + pressureFactorRate * 0.3);

                // 3. COST / SAFETY
                // Pressure is very expensive (thick pipes, pumping energy)
                // Temp is moderately expensive (fuel)
                const cost = (pressure * 1.5) + (temp * 0.2);

                setYieldVal(Math.round(calculatedYield));
                setRateVal(Math.round(calculatedRate));
                setCostVal(Math.round(cost));

                // 4. PROFIT CALCULATION
                // Profit = (Product Produced) - Cost
                // Product Produced = Yield % * Rate Speed
                const production = (calculatedYield * calculatedRate) / 10;
                const profit = Math.round((production * 15) - cost);
                setDailyProfit(profit);

                generateFeedback(calculatedYield, calculatedRate, cost, profit);
            };

            const generateFeedback = (y, r, c, p) => {
                if (pressure > 350) {
                    setFeedback("DANGER: Pressure dangerously high! Risk of explosion.");
                    return;
                }
                if (temp > 600) {
                    setFeedback("WARNING: Catalyst damage possible at this temperature.");
                    return;
                }
                if (p > 3000) {
                    setFeedback("OPTIMAL: Excellent compromise conditions achieved!");
                } else if (y < 20) {
                    setFeedback("INEFFICIENT: Yield is too low. Equilibrium favors reactants.");
                } else if (r < 20) {
                    setFeedback("TOO SLOW: Production rate is negligible.");
                } else {
                    setFeedback("OPERATIONAL: Adjust conditions to maximize profit.");
                }
            };

            const Gauge = ({ label, value, color, unit }) => (
                <div className="bg-slate-800 p-4 rounded-xl border border-slate-700">
                    <div className="flex justify-between mb-2">
                        <span className="text-xs font-bold text-slate-400 uppercase">{label}</span>
                        <span className={`text-sm font-black text-${color}-400`}>{value}{unit}</span>
                    </div>
                    <div className="w-full h-3 bg-slate-900 rounded-full overflow-hidden">
                        <div 
                            className={`h-full bg-${color}-500 gauge-fill`} 
                            style={{ width: `${Math.min(100, value)}%` }}
                        ></div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen p-6 font-sans flex flex-col items-center">
                    <div className="w-full max-w-5xl">
                        
                        {/* Header */}
                        <div className="flex items-center justify-between mb-8">
                            <div className="flex items-center gap-4">
                                <a href="index.html" className="p-3 bg-slate-800 hover:bg-slate-700 rounded-xl transition text-slate-400 hover:text-white">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                                </a>
                                <div>
                                    <h1 className="text-2xl font-black text-white tracking-tight">Haber Process Control</h1>
                                    <p className="text-sm text-slate-400 font-medium">N₂(g) + 3H₂(g) ⇌ 2NH₃(g) | ΔH = -92 kJ/mol</p>
                                </div>
                            </div>
                            <div className={`px-6 py-3 rounded-xl font-mono font-bold text-xl border ${dailyProfit > 0 ? 'bg-emerald-900/50 border-emerald-500 text-emerald-400' : 'bg-rose-900/50 border-rose-500 text-rose-400'}`}>
                                ${dailyProfit}/hr
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-12 gap-6">
                            
                            {/* Control Panel */}
                            <div className="lg:col-span-4 space-y-6">
                                <div className="bg-slate-800 p-6 rounded-2xl border border-slate-700 shadow-lg">
                                    <h2 className="text-xs font-black text-slate-500 uppercase tracking-widest mb-6">Reactor Settings</h2>
                                    
                                    {/* Temperature */}
                                    <div className="mb-8">
                                        <div className="flex justify-between mb-2">
                                            <label className="text-sm font-bold text-slate-300">Temperature</label>
                                            <span className="text-xs font-black text-orange-400">{temp}°C</span>
                                        </div>
                                        <input 
                                            type="range" min="200" max="700" value={temp} 
                                            onChange={(e) => setTemp(Number(e.target.value))} 
                                            className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-orange-500" 
                                        />
                                        <div className="flex justify-between mt-1 text-[10px] text-slate-500 font-mono">
                                            <span>200°C</span>
                                            <span>700°C</span>
                                        </div>
                                    </div>

                                    {/* Pressure */}
                                    <div>
                                        <div className="flex justify-between mb-2">
                                            <label className="text-sm font-bold text-slate-300">Pressure</label>
                                            <span className="text-xs font-black text-blue-400">{pressure} atm</span>
                                        </div>
                                        <input 
                                            type="range" min="1" max="400" value={pressure} 
                                            onChange={(e) => setPressure(Number(e.target.value))} 
                                            className="w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500" 
                                        />
                                        <div className="flex justify-between mt-1 text-[10px] text-slate-500 font-mono">
                                            <span>1 atm</span>
                                            <span>400 atm</span>
                                        </div>
                                    </div>
                                </div>

                                {/* Status Box */}
                                <div className="bg-black/40 p-4 rounded-xl border border-slate-700">
                                    <div className="text-[10px] font-bold text-slate-500 uppercase mb-2">System Status</div>
                                    <p className={`font-bold text-sm ${feedback.includes("DANGER") ? "text-rose-500 animate-pulse" : feedback.includes("OPTIMAL") ? "text-emerald-400" : "text-slate-300"}`}>
                                        {feedback}
                                    </p>
                                </div>
                            </div>

                            {/* Dashboard & Visualization */}
                            <div className="lg:col-span-8 space-y-6">
                                {/* Visual Factory */}
                                <div className="bg-slate-800 h-48 rounded-2xl border border-slate-700 relative overflow-hidden flex items-center justify-center">
                                    {/* Simple CSS Art for Reactor */}
                                    <div className="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')]"></div>
                                    
                                    {/* Pipes */}
                                    <div className="w-full flex items-center justify-center gap-0">
                                        <div className="h-4 w-1/4 bg-slate-600 relative">
                                            <div className="absolute top-[-20px] left-4 text-[10px] text-slate-500">N₂ + H₂</div>
                                            {/* Flow animation speed based on Rate */}
                                            <div className="h-full bg-blue-500/30 animate-pulse" style={{ animationDuration: `${200/rateVal}s` }}></div>
                                        </div>
                                        <div className={`w-32 h-32 rounded-full border-4 flex items-center justify-center relative shadow-2xl transition-colors duration-500 ${temp > 500 ? 'border-orange-500 bg-orange-900/20' : 'border-slate-500 bg-slate-900'}`}>
                                            <span className="font-black text-2xl text-white opacity-50">Fe</span>
                                            {pressure > 300 && <div className="absolute inset-0 rounded-full border-4 border-rose-500 animate-ping opacity-50"></div>}
                                        </div>
                                        <div className="h-4 w-1/4 bg-slate-600 relative">
                                            <div className="absolute top-[-20px] right-4 text-[10px] text-emerald-500">NH₃ (l)</div>
                                            {/* Opacity based on Yield */}
                                            <div className="h-full bg-emerald-500 transition-opacity duration-500" style={{ opacity: yieldVal/100 }}></div>
                                        </div>
                                    </div>
                                </div>

                                {/* Data Gauges */}
                                <div className="grid grid-cols-2 gap-4">
                                    <Gauge label="Equilibrium Yield" value={yieldVal} color="emerald" unit="%" />
                                    <Gauge label="Reaction Rate" value={rateVal} color="blue" unit="%" />
                                    <Gauge label="Operational Cost" value={costVal} color="rose" unit="" />
                                    <div className="bg-slate-800 p-4 rounded-xl border border-slate-700 flex flex-col justify-center">
                                        <div className="text-[10px] text-slate-500 uppercase font-bold mb-1">Target Conditions</div>
                                        <div className="text-sm text-slate-300">Temp: <span className="text-white font-bold">400-450°C</span></div>
                                        <div className="text-sm text-slate-300">Press: <span className="text-white font-bold">200 atm</span></div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
